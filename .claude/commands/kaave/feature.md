# 機能開発

## 依頼内容

$ARGUMENTS

## 作業フロー

次の順番を守って作業を行うこと:

1. **仕様明確化**: 依頼内容を深く考えて分析し、実装上の障害となりうる曖昧な点を洗い出し確認する。
2. **現状分析**: コードベースの調査と影響範囲の特定を行う。
3. **計画作成**: 1, 2より実際の作業内容を洗い出し、Epic/Task への分解を行い、 開発計画を作成する。
4. **実装**: Task 単位で、段階的な実装を行う。
5. **品質確認**: 各 Task 完了時に規定の品質確認処理を実行し、通過するまで改善を行う。

## 品質確認手順

プロジェクトによって異なるため、次を基準に決定する:

- package.json が存在する: `pnpm check` を実行する。
- Makefile が存在する: `make check` を実行する。
- 該当なし: 事前に確認する。

## ルール

- いきなり実装を開始することは絶対にしない。まず仕様の明確化と現状のコードベースやシステムの把握を行い、開発計画を作成する。
- 作成した開発計画は docs/work-plan.md に保存する。
- 開発計画は Epic と Task の階層構造で作成する。ただし、差分が数十行にとどまる規模の変更であれば Epic は省略しても構わない。
- Epic は最低限の顧客価値が提供できるかどうかを大まかな目安とする。例えば「新しい設定ページを追加し、あわせて必要なコンポーネントとネットワークリクエスト処理の追加」などである。
- Task は Pull Request 単位を基準とする。つまり、自動生成ファイルや Lock ファイルを除き、最終的な差分が最大で 200 行程度になるよう小規模に留める。
- Task は個別のモジュールを作り込んでから結合するのではなく、先に必要なモジュールをラフに実装し繋ぎこんだ後にそれぞれの要素の詳細を実装する、という順番で進める。おおよそ次の手順で実装する:
  1. 全体をコメントや型を活用して少しずつ肉付けしながら構築する。
  2. 固定値（モック）で全体の動作をざっくりと確認できるところまで実装する。この段階で、必要であればテストなど動作確認用のコードを作成する。
  3. 動的な値や、外部 API を利用して動作するように実装する。
- Task に含まれない変更を実施したい場合は、どんなに細かいものであってもまず実行可否を確認する。
- Epic や Task を実行する前と後には docs/work-plan.md を更新し、実装中 / 実装完了がそれぞれはっきりとわかるようにしておき、なにかしらの問題で作業が中断し Claude Code のセッションが終了してしまった場合にも docs/work-plan.md から作業を再開できるようにしておく。
